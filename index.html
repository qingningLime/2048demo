<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2048 Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f2f2f2;
      margin: 0;
      flex-direction: column;
    }
    #score, #best-score, #move-count {
      font-size: 24px;
      margin-bottom: 10px;
    }
    .game-container {
      width: 400px;
      height: 400px;
      background-color: #bbada0;
      border-radius: 10px;
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: repeat(4, 1fr);
      gap: 10px;
      padding: 10px;
      position: relative;
    }
    .tile {
      background-color: #ccc0b4;
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 36px;
      font-weight: bold;
      color: #776e65;
      transition: transform 0.2s ease-in-out;
    }
    .tile-2 { background-color: #eee4da; }
    .tile-4 { background-color: #ede0c8; }
    .tile-8 { background-color: #f2b179; }
    .tile-16 { background-color: #f59563; }
    .tile-32 { background-color: #f67c5f; }
    .tile-64 { background-color: #f65e3b; }
    .tile-128 { background-color: #edcf72; }
    .tile-256 { background-color: #edcc61; }
    .tile-512 { background-color: #edc850; }
    .tile-1024 { background-color: #edc53f; }
    .tile-2048 { background-color: #edc22e; }
    .tile-2, .tile-4 { color: #776e65; }
    .tile-8, .tile-16, .tile-32, .tile-64 { color: #f9f6f2; }
    .tile-128, .tile-256, .tile-512, .tile-1024, .tile-2048 { color: #f9f6f2; }
    .merge {
      animation: merge 0.2s ease-in-out;
    }
    @keyframes merge {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>

<div id="score">Score: 0</div>
<div id="best-score">Best Score: 0</div>
<div id="move-count">Move Count: 0</div>
<button id="reset-button">Reset Game</button>
<div class="game-container" id="game-board"></div>

<script>
  const boardSize = 4;
  const board = [];
  const gameBoard = document.getElementById('game-board');
  let score = 0;
  let bestScore = localStorage.getItem('bestScore') || 0;
  let moveCount = 0;

  document.getElementById('best-score').textContent = `Best Score: ${bestScore}`;

  function initializeBoard() {
    for (let i = 0; i < boardSize; i++) {
      board[i] = [];
      for (let j = 0; j < boardSize; j++) {
        board[i][j] = 0;
      }
    }
    moveCount = 0;
    document.getElementById('move-count').textContent = 'Move Count: 0';
    addRandomTile();
    addRandomTile();
    renderBoard();
  }

  function addRandomTile() {
    const emptyCells = [];
    for (let i = 0; i < boardSize; i++) {
      for (let j = 0; j < boardSize; j++) {
        if (board[i][j] === 0) {
          emptyCells.push({ row: i, col: j });
        }
      }
    }
    if (emptyCells.length > 0) {
      const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
      board[randomCell.row][randomCell.col] = Math.random() > 0.9 ? 4 : 2;
    }
  }

  function renderBoard() {
    gameBoard.innerHTML = '';
    for (let i = 0; i < boardSize; i++) {
      for (let j = 0; j < boardSize; j++) {
        const tile = document.createElement('div');
        tile.classList.add('tile');
        if (board[i][j] !== 0) {
          tile.classList.add(`tile-${board[i][j]}`);
          tile.textContent = board[i][j];
        }
        gameBoard.appendChild(tile);
      }
    }
  }

  function updateScore(amount) {
    score += amount;
    document.getElementById('score').textContent = `Score: ${score}`;
  }

  function updateBestScore() {
    if (score > bestScore) {
      bestScore = score;
      localStorage.setItem('bestScore', bestScore);
      document.getElementById('best-score').textContent = `Best Score: ${bestScore}`;
    }
  }

  function checkGameOver() {
    for (let i = 0; i < boardSize; i++) {
      for (let j = 0; j < boardSize; j++) {
        if (board[i][j] === 0) {
          return false;
        }
        if ((i > 0 && board[i][j] === board[i - 1][j]) || 
            (j > 0 && board[i][j] === board[i][j - 1])) {
          return false;
        }
      }
    }
    return true;
  }

  function moveTiles(direction) {
    let moved = false;
    switch (direction) {
      case 'up':
        for (let j = 0; j < boardSize; j++) {
          for (let i = 1; i < boardSize; i++) {
            if (board[i][j] !== 0) {
              let k = i;
              while (k > 0 && board[k - 1][j] === 0) {
                board[k - 1][j] = board[k][j];
                board[k][j] = 0;
                k--;
                moved = true;
              }
              if (k > 0 && board[k - 1][j] === board[k][j]) {
                board[k - 1][j] *= 2;
                board[k][j] = 0;
                updateScore(board[k - 1][j]);
                moved = true;
              }
            }
          }
        }
        break;
      case 'down':
        for (let j = 0; j < boardSize; j++) {
          for (let i = boardSize - 2; i >= 0; i--) {
            if (board[i][j] !== 0) {
              let k = i;
              while (k < boardSize - 1 && board[k + 1][j] === 0) {
                board[k + 1][j] = board[k][j];
                board[k][j] = 0;
                k++;
                moved = true;
              }
              if (k < boardSize - 1 && board[k + 1][j] === board[k][j]) {
                board[k + 1][j] *= 2;
                board[k][j] = 0;
                updateScore(board[k + 1][j]);
                moved = true;
              }
            }
          }
        }
        break;
      case 'left':
        for (let i = 0; i < boardSize; i++) {
          for (let j = 1; j < boardSize; j++) {
            if (board[i][j] !== 0) {
              let k = j;
              while (k > 0 && board[i][k - 1] === 0) {
                board[i][k - 1] = board[i][k];
                board[i][k] = 0;
                k--;
                moved = true;
              }
              if (k > 0 && board[i][k - 1] === board[i][k]) {
                board[i][k - 1] *= 2;
                board[i][k] = 0;
                updateScore(board[i][k - 1]);
                moved = true;
              }
            }
          }
        }
        break;
      case 'right':
        for (let i = 0; i < boardSize; i++) {
          for (let j = boardSize - 2; j >= 0; j--) {
            if (board[i][j] !== 0) {
              let k = j;
              while (k < boardSize - 1 && board[i][k + 1] === 0) {
                board[i][k + 1] = board[i][k];
                board[i][k] = 0;
                k++;
                moved = true;
              }
              if (k < boardSize - 1 && board[i][k + 1] === board[i][k]) {
                board[i][k + 1] *= 2;
                board[i][k] = 0;
                updateScore(board[i][k + 1]);
                moved = true;
              }
            }
          }
        }
        break;
    }
    if (moved) {
      moveCount++;
      document.getElementById('move-count').textContent = `Move Count: ${moveCount}`;
      addRandomTile();
      if (checkGameOver()) {
        alert('Game Over');
        updateBestScore();
        score = 0;
        moveCount = 0;
        document.getElementById('score').textContent = 'Score: 0';
        document.getElementById('move-count').textContent = 'Move Count: 0';
        initializeBoard();
      }
    }
    renderBoard();
  }

  document.addEventListener('keydown', (event) => {
    switch (event.key) {
      case 'ArrowUp':
        moveTiles('up');
        break;
      case 'ArrowDown':
        moveTiles('down');
        break;
      case 'ArrowLeft':
        moveTiles('left');
        break;
      case 'ArrowRight':
        moveTiles('right');
        break;
    }
  });

  document.getElementById('reset-button').addEventListener('click', () => {
    score = 0;
    moveCount = 0;
    document.getElementById('score').textContent = 'Score: 0';
    document.getElementById('move-count').textContent = 'Move Count: 0';
    initializeBoard();
  });

  initializeBoard();
</script>

</body>
</html>
